Import all necessary packages.

```{r}
library(dplyr)
library(ggplot2)
library(EnvStats)
library(outliers)
```
Set working directory, load all the grasping data and combine it into one dataframe.

```{r}
# Set working directory to the folder containing the CSV files
setwd("D:/Documents/Uni/BA/Analysis/CLEANED")

# Get list of all CSV files for the grapsing task in the folder
file_list <- list.files(pattern = "*_grasping.csv$")


# Create an empty data frame to store the combined data
combined_data <- data.frame()

# Loop through each CSV file
for (file in file_list) {
  # Read the CSV file into a data frame
  file_data <- read.csv(file, header = TRUE)
  # Extract the number from the filename and add as a new column
  number <- as.numeric(gsub("[^0-9]+", "", file))
  file_data$participant_id <- number
  # Append the data to the combined data frame
  combined_data <- rbind(combined_data, file_data)
}

# Save the combined data frame as a CSV file
write.csv(combined_data, "combined.csv", row.names = FALSE)
```

Calculate the amount of failed trials per condition.

```{r}
# Calculate amount of rows where success column is equal to "fail" per condition
fail_counts <- combined_data %>%
  group_by(condition) %>%
  summarize(fail_count = sum(success == "fail"), exFail_count = sum(success == "exFail"))

# Print the resulting table
print(fail_counts)
```

Calculate mean times per participant and visualize them.
```{r}
# Drop all unsuccessful trials
combined_data <- combined_data[combined_data$success == "success",]
```

```{r}
# Calculate the mean times for each participant
mean_times <- combined_data %>%
  group_by(participant_id, condition) %>%
  summarize(mean_time = mean(time))

# Save the mean trial times for each participant by condition
mean_times_auditory <- subset(mean_times, condition == "auditory")
mean_times_tactile <- subset(mean_times, condition == "tactile")


ggplot(mean_times, aes(x = condition, y = mean_time, fill = as.factor(participant_id))) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(x = "Condition", y = "Mean time", fill = "Participant ID") +
  theme_bw()

ggplot(mean_times, aes(x = condition, y = mean_time)) +
  geom_boxplot() +
  labs(x = "Condition", y = "Mean Time") +
  ggtitle("Mean Time per Condition")
```
Do various test and visualization to check for normality of the underlying distribution of each condition.

```{r}
# Split the data by condition
auditory_data <- combined_data[combined_data$condition == "auditory",]
tactile_data <- combined_data[combined_data$condition == "tactile",]

# Drop rows where success column is not equal to "success"
auditory_data <- auditory_data[auditory_data$success == "success",]
tactile_data <- tactile_data[tactile_data$success == "success",]

# Check for normality using histogram and normal probability plot for each condition
par(mfrow=c(2,2)) # create 2x2 plot grid

# Histogram and normal probability plot for auditory condition
hist(auditory_data$time, main="Histogram of Auditory Times", xlab="Times")
qqnorm(auditory_data$time, main="Normal Probability Plot of Auditory Times")
qqline(auditory_data$time)

# Histogram and normal probability plot for tactile condition
hist(tactile_data$time, main="Histogram of Tactile Times", xlab="Times")
qqnorm(tactile_data$time, main="Normal Probability Plot of Tactile Times")
qqline(tactile_data$time)

# Perform Shapiro-Wilk test for normality for each condition
shapiro.test(auditory_data$time)
shapiro.test(tactile_data$time)

# Perform Kolmogorov-Smirnov test for each condition
ks.test(auditory_data$time, "pnorm", mean(auditory_data$time), sd(auditory_data$time))
ks.test(tactile_data$time, "pnorm", mean(tactile_data$time), sd(tactile_data$time))
```

Look for outliers in the data.
```{r}
ggplot(combined_data, aes(x = condition, y = time)) +
  geom_boxplot() +
  labs(x = "Condition", y = "Time") +
  ggtitle("Trial times per Condition")

# Grubbs' test by condition
grubbs_results <- by(combined_data$time, combined_data$condition, grubbs.test)
print(grubbs_results)


```
Perform a Wilcoxon signed-rank test.

```{r}
# Perform Wilcoxon signed-rank test
wilcox.test(auditory_data$time, tactile_data$time, paired = FALSE)


# Perform Wilcoxon signed-rank test on the mean reaction times for each participant
wilcox.test(mean_times_auditory$mean_time, mean_times_tactile$mean_time, paired = TRUE)
```